#ifndef kasinskyexam_H_
#define kasinskyexam_H_

/* Determines most likeley key sizes using Kasinski's examination 
 * Returns: void
 * Input: cipherText, keyLengths array
 * */
extern void returnKeyLengths(char *cipherText, uint *keyLengths);

extern void crackVig(char *cipherText, cchar *alphabet);

/* English text, this could be populated by another language
 * to assist frequency analysis in another language
 * */


#define enDict "Itwasmarket-day,andfromallthecountryroundGodervillethepeasantsandtheirwiveswerecomingtowardthetown.Themenwalkedslowly,throwingthewholebodyforwardateverystepoftheirlong,crookedlegs.Theyweredeformedfrompushingtheploughwhichmakestheleft-shoulderhigher,andbendstheirfiguresside-ways;fromreapingthegrain,whentheyhavetospreadtheirlegssoastokeepontheirfeet.Theirstarchedblueblouses,glossyasthoughvarnished,ornamentedatcollarandcuffswithalittleembroidereddesignandblownoutaroundtheirbonybodies,lookedverymuchlikeballoonsabouttosoar,whenceissuedtwoarmsandtwofeet.Someofthesefellowsdraggedacoworacalfattheendofarope.Andjustbehindtheanimalfollowedtheirwivesbeatingitoverthebackwithaleaf-coveredbranchtohastenitspace,andcarryinglargebasketsoutofwhichprotrudedtheheadsofchickensorducks.Thesewomenwalkedmorequicklyandenergeticallythanthemen,withtheirerect,dried-upfigures,adornedwithscantylittleshawlspinnedovertheirflatbosoms,andtheirheadswrappedroundwithawhitecloth,enclosingthehairandsurmountedbyacap.Nowachar-a-bancpassedby,joggingalongbehindanagandshakingupstrangelythetwomenontheseat,andthewomanatthebottomofthecartwhoheldfasttoitssidestolessenthehardjolting.Inthemarket-placeatGodervillewasagreatcrowd,amingledmultitudeofmenandbeasts.Thehornsofcattle,thehigh,long-nappedhatsofwealthypeasants,theheaddressesofthewomencametothesurfaceofthatsea.Andthesharp,shrill,barkingvoicesmadeacontinuous,wilddin,whileaboveitoccasionallyroseahugeburstoflaughterfromthesturdylungsofamerrypeasantoraprolongedbellowfromacowtiedfasttothewallofahouse.Itallsmelledofthestable,ofmilk,ofhayandofperspiration,givingoffthathalf-human,half-animalodorwhichispeculiartocountryfolks.MaitreHauchecorne,ofBreaute,hadjustarrivedatGodervilleandwasmakinghiswaytowardthesquarewhenheperceivedonthegroundalittlepieceofstring.MaitreHauchecorne,economicalasarealltrueNormans,reflectedthateverythingwasworthpickingupwhichcouldbeofanyuse,andhestoopeddown,butpainfully,becausehesufferedfromrheumatism.HetookthebitofthinstringfromthegroundandwascarefullypreparingtorollitupwhenhesawMaitreMalandain,theharnessmaker,onhisdoorstepstaringathim.Theyhadoncehadaquarrelaboutahalter,andtheyhadborneeachothermaliceeversince.MaitreHauchecornewasovercomewithasortofshameatbeingseenbyhisenemypickingupabitofstringintheroad.Hequicklyhiditbeneathhisblouseandthenslippeditintohisbreeches,pocket,thenpretendedtobestilllookingforsomethingonthegroundwhichhedidnotdiscoverandfinallywentofftowardthemarket-place,hisheadbentforwardandhisbodyalmostdoubledintwobyrheumaticpains.Hewasatoncelostinthecrowd,whichkeptmovingaboutslowlyandnoisilyasitchafferedandbargained.Thepeasantsexaminedthecows,wentoff,cameback,alwaysindoubtforfearofbeingcheated,neverquitedaringtodecide,lookingthesellersquareintheeyeintheefforttodiscoverthetricksofthemanandthedefectinthebeast.Thewomen,havingplacedtheirgreatbasketsattheirfeet,hadtakenoutthepoultry,whichlayupontheground,theirlegstiedtogether,withterrifiedeyesandscarletcombs.Theylistenedtopropositions,maintainingtheirpricesinadecidedmannerwithanimpassivefaceorperhapsdecidingtoacceptthesmallerpriceoffered,suddenlycallingouttothecustomerwhowasstartingtogoaway:Allright,I'llletyouhavethem,Mait'Anthime.Then,littlebylittle,thesquarebecameempty,andwhentheAngelusstruckmiddaythosewholivedatadistancepouredintotheinns.AtJourdain'sthegreatroomwasfilledwitheaters,justasthevastcourtwasfilledwithvehiclesofeverysort--wagons,gigs,chars-a-bancs,tilburies,innumerablevehicleswhichhavenoname,yellowwithmud,misshapen,piecedtogether,raisingtheirshaftstoheavenliketwoarms,oritmaybewiththeirnoseonthegroundandtheirrearintheair.Justoppositetowherethedinerswereattablethehugefireplace,withitsbrightflame,gaveoutaburningheatonthebacksofthosewhosatattheright.Threespitswereturning,loadedwithchickens,withpigeonsandwithjointsofmutton,andadelectableodorofroastmeatandofgravyflowingovercrispbrownskinarosefromthehearth,kindledmerriment,causedmouthstowater.AllthearistocracyoftheploughwereeatingthereatMait'Jourdain's,theinnkeeper's,adealerinhorsesalsoandasharpfellowwhohadmadeagreatdealofmoneyinhisday.Thedisheswerepassedround,wereemptied,aswerethejugsofyellowcider.Everyonetoldofhisaffairs,ofhispurchasesandhissales.Theyexchangednewsaboutthecrops.Theweatherwasgoodforgreens,buttoowetforgrain.Suddenlythedrumbegantobeatinthecourtyardbeforethehouse.Everyone,exceptsomeofthemostindifferent,wasontheirfeetatonceandrantothedoor,tothewindows,theirmouthsfullandnapkinsintheirhand.Whenthepubliccrierhadfinishedhistattoohecalledforthinajerkyvoice,pausinginthewrongplaces:BeitknowntotheinhabitantsofGodervilleandingeneraltoallpersonspresentatthemarketthattherehasbeenlostthismorningontheBeuzevilleroad,betweennineandteno'clock,ablackleatherpocketbookcontainingfivehundredfrancsandbusinesspapers.Youarerequestedtoreturnittothemayor'sofficeatonceortoMaitreFortuneHoulbreque,ofManneville.Therewillbetwentyfrancsreward.Thenthemanwentaway.Theyheardoncemoreatadistancethedullbeatingofthedrumandthefaintvoiceofthecrier.Thentheyallbegantotalkofthisincident,reckoningupthechanceswhichMaitreHoulbrequehadoffindingorofnotfindinghispocketbookagain.Themealwenton.Theywerefinishingtheircoffeewhenthecorporalofgendarmesappearedonthethreshold.Heasked:IsMaitreHauchecorne,ofBreaute,here?MaitreHauchecorne,seatedattheotherendofthetableanswered:HereIam,hereIam.Andhefollowedthecorporal.Themayorwaswaitingforhim,seatedinanarmchair.Hewasthenotaryoftheplace,atall,gravemanofpompousspeech.MaitreHauchecorne,saidhe,thismorningontheBeuzevilleroad,youwereseentopickupthepocketbooklostbyMaitreHoulbreque,ofManneville.Thecountrymanlookedatthemayorinamazementfrightenedalreadyatthissuspicionwhichrestedonhim,heknewnotwhy.I--Ipickedupthatpocketbook?Yes,YOU.IswearIdon'tevenknowanythingaboutit.Youwereseen.Iwasseen--I?Whosawme?M.Malandain,theharness-maker.Thentheoldmanremembered,understood,and,reddeningwithanger,said:Ah!hesawme,didhe,therascal?Hesawmepickingupthisstringhere,M'sieuleMaire.Andfumblingatthebottomofhispocket,hepulledoutofitthelittleendofstring.Butthemayorincredulouslyshookhishead:Youwillnotmakemebelieve,MaitreHauchecorne,thatM.Malandain,whoisamanwhosewordcanbereliedon,hasmistakenthisstringforapocketbook.Thepeasant,furious,raisedhishandandspatonthegroundbesidehimasiftoattesthisgoodfaith,repeating:Forallthat,itisGod'struth,M'sieuleMaire.There!Onmysoul'ssalvation,Irepeatit.Themayorcontinued:Afteryoupickeduptheobjectinquestion,youevenlookedaboutforsometimeinthemudtoseeifapieceofmoneyhadnotdroppedoutofit.Thegoodmanwaschokingwithindignationandfear.Howcantheytell--howcantheytellsuchliesasthattoslanderanhonestman!Howcanthey?Hisprotestationswereinvain;hewasnotbelieved.HewasconfrontedwithM.Malandain,whorepeatedandsustainedhistestimony.Theyrailedatoneanotherforanhour.AthisownrequestMaitreHauchecornewassearched.Nothingwasfoundonhim.Atlastthemayor,muchperplexed,senthimaway,warninghimthathewouldinformthepublicprosecutorandaskfororders.Thenewshadspread.Whenheleftthemayor'sofficetheoldmanwassurrounded,interrogatedwithacuriositywhichwasseriousormocking,asthecasemightbe,butintowhichnoindignationentered.Andhebegantotellthestoryofthestring.Theydidnotbelievehim.Theylaughed.Hepassedon,buttonholedbyeveryone,himselfbuttonholinghisacquaintances,beginningoverandoveragainhistaleandhisprotestations,showinghispocketsturnedinsideouttoprovethathehadnothinginthem.Theysaidtohim:Youoldrogue!Hegrewmoreandmoreangry,feverish,indespairatnotbeingbelieved,andkeptontellinghisstory.Thenightcame.Itwastimetogohome.Heleftwiththreeofhisneighbors,towhomhepointedouttheplacewherehehadpickedupthestring,andallthewayhetalkedofhisadventure.ThateveninghemadetheroundofthevillageofBreauteforthepurposeoftellingeveryone.Hemetonlyunbelievers.Hebroodedoveritallnightlong.Thenextday,aboutoneintheafternoon,MariusPaumelle,afarmhandofMaitreBreton,themarketgardeneratYmauville,returnedthepocketbookanditscontentstoMaitreHolbreque,ofManneville.Thismansaid,indeed,thathehadfounditontheroad,butnotknowinghowtoread,hehadcarriedithomeandgivenittohismaster.Thenewsspreadtotheenvirons.MaitreHauchecornewasinformed.Hestartedoffatonceandbegantorelatehisstorywiththedenoument.Hewastriumphant.Whatgrievedme,saidhe,wasnotthethingitself,doyouunderstand,butitwasbeingaccusedoflying.Nothingdoesyousomuchharmasbeingindisgraceforlying.Alldayhetalkedofhisadventure.Hetolditontheroadstothepeoplewhopassed,atthecabarettothepeoplewhodrankandnextSundaywhentheycameoutofchurch.Heevenstoppedstrangerstotellthemaboutit.Hewaseasynow,andyetsomethingworriedhimwithouthisknowingexactlywhatitwas.Peoplehadajokingmannerwhiletheylistened.Theydidnotseemconvinced.Heseemedtofeeltheirremarksbehindhisback.OnTuesdayofthefollowingweekhewenttomarketatGoderville,promptedsolelybytheneedoftellinghisstory.Malandain,standingonhisdoorstep,begantolaughashesawhimpass.Why?HeaccostedafarmerofCriquetot,whodidnotlethirefinish,andgivinghimapunchinthepitofthestomachcriedinhisface:Oh,yougreatrogue!Thenheturnedhisheeluponhim.MaitreHauchecorneremainedspeechlessandgrewmoreandmoreuneasy.Whyhadtheycalledhimgreatrogue?WhenseatedattableinJourdain'stavernhebeganagaintoexplainthewholeaffair.AhorsedealerofMontivilliersshoutedathim:Getout,getout,youoldscamp!Iknowallaboutyouroldstring.Hauchecornestammered:Butsincetheyfounditagain,thepocketbook!Buttheothercontinued:Holdyourtongue,daddy;there'sonewhofindsitandthere'sanotherwhoreturnsit.Andnoonethewiser.Thefarmerwasspeechless.Heunderstoodatlast.Theyaccusedhimofhavinghadthepocketbookbroughtbackbyanaccomplice,byaconfederate.Hetriedtoprotest.Thewholetablebegantolaugh.Hecouldnotfinishhisdinner,andwentawayamidachorusofjeers.Hewenthomeindignant,chokingwithrage,withconfusion,themorecastdownsincewithhisNormancraftinesshewas,perhaps,capableofhavingdonewhattheyaccusedhimofandevenofboastingofitasagoodtrick.Hewasdimlyconsciousthatitwasimpossibletoprovehisinnocence,hiscraftinessbeingsowellknown.Hefelthimselfstrucktotheheartbytheinjusticeofthesuspicion.Hebegananewtotellhistale,lengtheninghisrecitaleveryday,eachdayaddingnewproofs,moreenergeticdeclarationsandmoresacredoaths,whichhethoughtof,whichhepreparedinhishoursofsolitude,forhismindwasentirelyoccupiedwiththestoryofthestring.Themorehedeniedit,themoreartfulhisarguments,thelesshewasbelieved.Thoseareliarsproofs,theysaidbehindhisback.Hefeltthis.Itpreyeduponhimandheexhaustedhimselfinuselessefforts.Hewasvisiblywastingaway.Jokerswouldmakehimtellthestoryofthepieceofstringtoamusethem,justasyoumakeasoldierwhohasbeenonacampaigntellhisstoryofthebattle.HismindkeptgrowingweakerandabouttheendofDecemberhetooktohisbed.HepassedawayearlyinJanuary,and,intheravingsofdeathagony,heprotestedhisinnocence,repeating:Alittlebitofstring--alittlebitofstring.See,hereitis,M'sieuleMaire."

#endif
